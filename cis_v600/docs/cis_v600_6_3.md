## Description

Security groups provide stateful filtering of ingress and egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to remote server administration ports, such as SSH on port 22 and RDP on port 3389, using either the TCP (6), UDP (17), or ALL (-1) protocols.

## Remediation

### From Console:

Perform the following to implement the prescribed state:

1. Login to the AWS VPC Console at https://console.aws.amazon.com/vpc/home.
2. In the left pane, click `Security Groups.`
3. For each security group, perform the following:
- Select the security group.
- Click the `Inbound Rules` tab.
- Click the `Edit inbound rules` button.
- Identify the rules to be edited or removed.
- Either (A) update the Source field to a range other than 0.0.0.0/0, or (B) click `Delete` to remove the offending inbound rule.
- Click `Save` rules.

### From Command Line:

1. Check all security groups for insecure inbound rules allowing traffic from
0.0.0.0/0:

```bash
aws ec2 describe-security-group-rules --query 'SecurityGroupRules[?CidrIpv4 == "0.0.0.0/0" && IsEgress == `false`]' --output json
```

2. Delete the insecure rule(s) based on their rule ID:

```bash
aws ec2 delete-security-group-rules --group-id <security_group_id> --security-group-rule-ids <rule_id_to_delete>
```

3. Recreate necessary security group rules:

```bash
aws ec2 authorize-security-group-ingress --group-id <security_group_id> --protocol <tcp,udp,icmp or all> --port <port> --cidr <source_cidr>
```

## Default Value:

By default, security groups may be configured to allow unrestricted ingress (0.0.0.0/0) on ports like SSH (22) or RDP (3389). AWS does not block this automatically; restrictions must be applied manually.